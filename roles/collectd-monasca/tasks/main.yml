---
- name: create collectd configration dir
  become: yes
  file:
    path: /etc/collectd.d
    state: directory
  tags:
    - collectd-monasca

- name: configure collectd
  become: yes
  template:
    src: collectd.conf.j2
    dest: /etc/collectd.conf
  notify:
    - restart collectd
  tags:
    - collectd-monasca

- name: install collectd systemd service
  become: yes
  template:
    src: collectd.service.j2
    dest: /usr/lib/systemd/system/collectd.service
  notify:
    - systemd daemon-reload
  tags:
    - collectd-monasca

- name: enable and start collectd
  become: yes
  service:
    enabled: yes
    name: collectd
    state: started
  tags:
    - collectd-monasca
